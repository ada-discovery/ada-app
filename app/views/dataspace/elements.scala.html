@import views.html.elements.inputText
@import views.html.elements.{labelValue, value}
@import views.html.table.displayTable
@import util.typeColumns

@(
    form: Form[DataSpaceMetaInfo],
    dataSetIdSizeMap: Map[String, Int]
)(implicit msg: play.api.i18n.Messages)

@editableInput(key: String, value: Any) = {
    <input type="text" class="form-control" id="@key" name="@key" value="@value">
}

@table = {
    @displayTable(
        form.value.get.dataSetMetaInfos.sortBy(_.sortOrder),
        typeColumns[DataSetMetaInfo](
            (None, "Name", { item: DataSetMetaInfo => editableInput("dataSetMetaInfos.name", item.name) }),
            (None, "Sort Order", { item: DataSetMetaInfo => editableInput("dataSetMetaInfos.sortOrder", item.sortOrder) }),
            (None, "# Items/Patients", { item: DataSetMetaInfo => dataSetIdSizeMap.get(item.id).get.toString })
        ),
        None,
        None,
        Some("dataSetMetaInfos.id", { item: Any => item.asInstanceOf[DataSetMetaInfo]._id.get.stringify })
    )
}

@inputText("dataSpaceMetaInfo", "name", form)
@inputText("dataSpaceMetaInfo", "sortOrder", form)
@value("dataSetMetaInfos", "Time Created", form.value.get.timeCreated.toString)
@labelValue("dataSetMetaInfos", "Data Sets"){@table}