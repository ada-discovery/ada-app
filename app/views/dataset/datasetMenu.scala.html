@import controllers.dataset.DataSetRouter
@import models.DataSpaceMetaInfo
@import util.{getParamValue, matchesPath}
@import controllers.dataset.routes.{DataSpaceMetaInfoController => dataSpaceMetaInfoRoutes}


@(dataSpaceMetaInfos: Traversable[DataSpaceMetaInfo])(implicit request: Request[_])

@listItem(call: Call, dataSetId: String, text: String) = {
    @defining(getParamValue(request.uri, "dataSet")) { reqDataSetId =>
        <li @if(reqDataSetId.isDefined && reqDataSetId.get.equals(dataSetId)) {class="active dataset"} else {class="dataset"}>
            <a href="@call">
                <ul class="list-inline">
                    <li>
                        <span class="glyphicon glyphicon-chevron-right"></span>
                    </li>
                    <li>
                        <h5>@text</h5>
                    </li>
                </ul>
            </a>
        </li>
    }
}

@spaceItem(call: Call, text: String) = {
    <li @if(matchesPath(call.url, request.uri, Some(3))) {class="dataspace active"} else {class="dataspace"}>
        <a href="@call">
            <h4>@text</h4>
        </a>
    </li>
}

<!--
    <h3 class="text-muted" align="center">Studies</h3>
    <hr/>
-->

<ul class="sidebar-nav nav nav-pills nav-stacked">
    @dataSpaceMetaInfos.toSeq.sortBy(_.sortOrder).map { spaceMetaInfo =>
        @spaceItem(dataSpaceMetaInfoRoutes.get(spaceMetaInfo._id.get), spaceMetaInfo.name)
        @spaceMetaInfo.dataSetMetaInfos.sortBy(_.sortOrder).map { setMetaInfo =>
            @listItem(new DataSetRouter(setMetaInfo.id).plainOverviewList, setMetaInfo.id, setMetaInfo.name)
        }
    }
</ul>