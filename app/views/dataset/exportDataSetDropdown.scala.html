@import models.FilterCondition
@import views.html.{exportModal, exportDropdown}
@import views.html.elements.labelValue

@(
    conditions: Seq[FilterCondition],
    exportCsvCall: (String, Seq[FilterCondition], Boolean) => Call,
    exportJsonCall: (Seq[FilterCondition], Boolean) => Call,
    exportTranSMARTDataCall: Call,
    exportTranSMARTMappingCall: Call
)

@modalBody(defaultDelimiter: String) = {
    <fieldset>
        @labelValue("delimiter", "Delimiter") {
            <input id="delimiter" name="delimiter" value="@defaultDelimiter">
        }
    </fieldset>
}

@exportDropdown(
    conditions,
    exportCsvCall,
    exportJsonCall
) {
    <li role="separator" class="divider"></li>
    <li>
        <a href="#" data-toggle="modal" data-target="#exportTranSMARTDataModal">
            Export TranSMART Data
        </a>
    </li>
    <li>
        <a href="#" data-toggle="modal" data-target="#exportTranSMARTMappingModal">
            Export TranSMART Mapping
        </a>
    </li>
    <li role="separator" class="divider"></li>
    <li>
        <a href="#" onclick="exportCharts('image/png');">
            Export Charts as PNG
        </a>
    </li>
    <li>
        <a href="#" onclick="exportCharts('image/svg+xml');">
            Export Charts as SVG
        </a>
    </li>
    <li>
        <a href="#" onclick="exportCharts('application/pdf');">
            Export Charts as PDF
        </a>
    </li>
} {
    @exportModal("exportTranSMARTDataModal", "CSV TranSMART Data Export", exportTranSMARTDataCall, modalBody("\\t"))
    @exportModal("exportTranSMARTMappingModal", "CSV TranSMART Mapping Export", exportTranSMARTMappingCall, modalBody("\\t"))
}

<script type="text/javascript">
    function exportCharts(type) {
        var chartIds = $.map($(".chart-holder"), function (chart, i) {
            return chart.id;
        })
        Highcharts.exportCharts(chartIds, {type: type});
    }
</script>