@import views.html.layout
@import views.html.dataset.filterChartPanel
@import views.html.table.paginatedJsonTable
@import views.html.dataset.exportDropdown
@import play.api.libs.json.JsObject
@import play.modules.reactivemongo.json._
@import reactivemongo.bson.BSONObjectID
@import util.ChartSpec

@(
    domainName : String,
    page: Page[JsObject],
    fieldsToShow : Seq[String],
    fieldNameChartSpecs : Iterable[(String, ChartSpec)],

    // All calls wrapped in a router object
    router : DataSetRouter
)(
    implicit flash: play.api.mvc.Flash, msg: play.api.i18n.Messages, request: RequestHeader
)

@actions = {
    <div class="row">
        <div class="col-md-10">
            @filter(page.filter, router.plainOverviewListCall)
        </div>
        <div class="col-md-2">
            @exportDropdown(router.exportAllCsvCall, router.exportAllJsonCall, router.exportTranSMARTDataCall, router.exportTranSMARTMappingCall)
        </div>
    </div>
}

@table = @{
    paginatedJsonTable(
        page,
        router.overviewListCall(_, _, page.filter),
        Some(fieldsToShow),
        Some({ (item : JsObject) => router.getCall((item \ "_id").as[BSONObjectID])})
    )
}

@layout.list(
    domainName,
    page.total,
    actions,
    table,
    Some(filterChartPanel(fieldNameChartSpecs))
)