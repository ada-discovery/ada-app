@import views.html.layout
@import views.html.dataset.{filterChartPanel, datasetSubNav, datasetMenu, datasetActions}
@import views.html.chart.chartPanelJs
@import views.html.chart.highcharts.highchartsJsImport
@import views.html.table.paginatedJsonTable
@import play.api.libs.json.JsObject
@import play.modules.reactivemongo.json._
@import reactivemongo.bson.BSONObjectID
@import util.FieldChartSpec
@import play.api.mvc.Flash
@import play.api.i18n.Messages

@import controllers.dataset.DataSetRouter

@(
    domainName : String,
    page: Page[JsObject],
    fieldLabelMap: Map[String, String],
    fieldsToShow: Seq[String],
    fieldChartSpecs: Traversable[FieldChartSpec],
    router: DataSetRouter,
    dataSpaceMetaInfos: Traversable[DataSpaceMetaInfo]
)(
    implicit flash: Flash, msg: Messages, request: Request[_]
)

@actions = @{
    datasetActions(
        router,
        page
    )
}

@table = @{
    paginatedJsonTable(
        page,
        router.overviewList(_, _, page.filter),
        Some(fieldLabelMap),
        Some(fieldsToShow),
        Some({ item : JsObject => router.get((item \ "_id").as[BSONObjectID])})
    )
}

@bottomResources = {
    @highchartsJsImport()
    @chartPanelJs(fieldChartSpecs.map(_.chartSpec))
}

@layout.list(
    domainName,
    page.total,
    actions,
    table,
    Some(filterChartPanel(fieldChartSpecs)),
    Some(datasetMenu(dataSpaceMetaInfos)),
    Some(datasetSubNav()),
    None,
    Some(bottomResources)
)