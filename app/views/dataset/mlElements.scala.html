@import views.html.elements.{labelValue, selectEnum}
@import views.html.table.{dynamicStringTable, dynamicTableJsImport}
@import views.html.dataset.dynamicFieldTable
@import models.ml.VectorTransformType

@(
    includeChiSquareSelector: Boolean = false,
    includeOutputField: Boolean = true,
    extraFields: Option[Html] = None
)

@dynamicTableJsImport()

@modalBody(defaultFeaturesToSelectNum: Int, defaultDiscretizerBucketsNum: Int) = {
    <fieldset>
        @labelValue("featuresToSelectNum", "Features Num", false, None, 4) {
            <input id="featuresToSelectNum" name="featuresToSelectNum" value="@defaultFeaturesToSelectNum">
        }
        @labelValue("discretizerBucketsNum", "Discretizer Buckets Num", false, None, 4) {
            <input id="discretizerBucketsNum" name="discretizerBucketsNum" value="@defaultDiscretizerBucketsNum">
        }
    </fieldset>
}

@buttons = {
    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
    <button type="button" id="submitButton" class="btn btn-primary" data-dismiss="modal" onclick="selectFeaturesAsChiSquare(); return false;">OK</button>
}

@extraFieldButtons = {
    <a id="addAllFieldsButton" class="btn btn-info btn-sm" href="#" onclick="addAllFields();" data-toggle="tooltip" title="Add All Fields">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> All
    </a>
    @if(includeChiSquareSelector) {
        <a id="chiSquareFieldSelectionButton" class="btn btn-info btn-sm" data-toggle="modal" data-target="#chiSquareFeatureSelectionModal" title="Chi-Square Feature Selection">
            <span class="glyphicon glyphicon-minus" aria-hidden="true"></span> Chi-Square
        </a>
        @modal("chiSquareFeatureSelectionModal", "Chi-Square Feature Selection", modalBody(4, 10), None, Some(buttons))
    }
}

@labelValueAux(key: String, label: Any)(valueElement : Any) = @{
    labelValue(key, label, false, None, 4)(valueElement)
}

<div class="row">
    <form>
        <fieldset>
            <div class="col-md-6">
                @labelValueAux("mlModel", "ML Model") {
                    <input id="mlModelTypeahead" class="typeahead typeahead-large" type="text" placeholder="" value="">
                    <input id="mlModelId" name="mlModelId" type="hidden" value="">
                }
                @if(includeOutputField) {
                    @labelValueAux("outputField", "Output Field") {
                        <input id="outputFieldTypeahead" class="typeahead typeahead-large" type="text" placeholder="" value="">
                        <input id="outputFieldName" name="outputFieldName" type="hidden" value="">
                    }
                }
                @labelValueAux("inputFieldNames", "Input Fields") {
                    @dynamicFieldTable("inputFieldName", Nil, false, 12, Some(extraFieldButtons))
                }
                @labelValueAux("filterId", "Input Data") {
                    <input id="filterNameTypeahead" class="typeahead typeahead-large" type="text" placeholder="filter" value="">
                    <input id="filterId" name="filterId" type="hidden" value="">
                }
                <hr/>
                @labelValueAux("featuresNormalizationType", "Feature Normalization") {
                    @selectEnum("featuresNormalizationType", VectorTransformType, true, Some("input-lg"))
                }
                @labelValueAux("pcaDims", "PCA Dims") {
                    <input id="pcaDims" type="text" class="input-lg" placeholder="2 to number of features" value="">
                }
            </div>
            <div class="col-md-6">
                @if(extraFields.isDefined) {
                    @extraFields.get
                }
            </div>
        </fieldset>

        <div class="actions pull-right">
                <button id="launchButton" type="button" class="btn btn-primary">Submit</button>
        </div>
    </form>
</div>

<hr/>

<div class="row">
    <div id='outputDiv' class='col-md-6 col-md-offset-3'>
    </div>
</div>