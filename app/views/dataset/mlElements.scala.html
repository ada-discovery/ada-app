@import views.html.elements.{labelValue, selectEnum}
@import views.html.table.dynamicTableJsImport
@import views.html.dataset.dynamicFieldTable
@import models.ml.VectorTransformType
@import controllers.dataset.DataSetWebContext._
@import controllers.dataset.DataSetWebContext

@(
    includeOutputField: Boolean = true,
    includeFeatureSelectionNum: Boolean = true,
    extraFieldButtons: Option[Html] = None,
    extraFields: Option[Html] = None
)(
    implicit context: DataSetWebContext
)

@dynamicTableJsImport()

@fieldButtons = {
    <a id="addAllFieldsButton" class="btn btn-info btn-sm" href="#" onclick="addAllFields();" data-toggle="tooltip" title="Add All Fields">
        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> All
    </a>
    @if(extraFieldButtons.isDefined) {
        @extraFieldButtons.get
    }
}

@labelValueAux(key: String, label: Any)(valueElement : Any) = @{
    labelValue(key, label, false, None, 4)(valueElement)
}

<div class="row">
    <form>
        <fieldset>
            <div class="col-md-6">
                @labelValueAux("mlModel", "ML Model") {
                    <input id="mlModelTypeahead" class="typeahead typeahead-large" type="text" placeholder="" value="">
                    <input id="mlModelId" name="mlModelId" type="hidden" value="">
                }
                @if(includeOutputField) {
                    @labelValueAux("outputField", "Output Field") {
                        <input id="outputFieldTypeahead" class="typeahead typeahead-large" type="text" placeholder="" value="">
                        <input id="outputFieldName" name="outputFieldName" type="hidden" value="">
                    }
                }
                @labelValueAux("inputFieldNames", "Input Fields") {
                    @dynamicFieldTable(
                        "inputFieldName",
                        Nil,
                        false,
                        12,
                        Some(fieldButtons),
                        Some(Right(dataSetRouter.getCategoriesWithFieldsAsTreeNodes(Left(Nil))))
                    )
                }
                @labelValueAux("filterId", "Input Data") {
                    <input id="filterNameTypeahead" class="typeahead typeahead-large" type="text" placeholder="filter" value="">
                    <input id="filterId" name="filterId" type="hidden" value="">
                }
                <hr/>
                @labelValueAux("featuresNormalizationType", "Feature Normalization") {
                    @selectEnum("featuresNormalizationType", VectorTransformType, true, Some("input-lg"))
                }
                @if(includeFeatureSelectionNum) {
                    @labelValueAux("featuresSelectionNum", "Feature Selection  Num") {
                        <input id="featuresSelectionNum" type="text" class="input-lg" placeholder="1 to number of features" value="">
                    }
                }
                @labelValueAux("pcaDims", "PCA Dims") {
                    <input id="pcaDims" type="text" class="input-lg" placeholder="1 to number of features" value="">
                }
            </div>
            <div class="col-md-6">
                @if(extraFields.isDefined) {
                    @extraFields.get
                }
            </div>
        </fieldset>

        <div class="actions pull-right">
            <button id="launchButton" type="button" class="btn btn-primary">Submit</button>
        </div>
    </form>
</div>

<hr/>

<div class="row">
    <div id='outputDiv' class='col-md-6 col-md-offset-3'>
    </div>
</div>