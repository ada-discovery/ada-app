@import views.html.layout
@import views.html.elements.{inputText, select, value}
@import views.html.dataset.{datasetSubNav, datasetMenu}
@import controllers.dataset.FilterRouter
@import models.DataSpaceMetaInfo
@import models.Filter
@import reactivemongo.bson.BSONObjectID

@(
    domainName: String,
    id : BSONObjectID,
    form: Form[Filter],
    router: FilterRouter,
    dataSpaceMetaInfos: Traversable[DataSpaceMetaInfo]
)(
    implicit flash: play.api.mvc.Flash, msg: play.api.i18n.Messages, request: Request[_]
)

@elements = {
    @inputText("filter", "name", form)
    @value("filter", "Created By", form.value.map(_.createdBy.map(_.ldapDn)).flatten.getOrElse("") )
    @value("filter", "Time Created",  form.value.map(_.timeCreated.map(_.format("yyyy-MM-dd HH:mm:ss"))).flatten.getOrElse(""))
    @value("filter", "Conditions", form.value.map(_.conditions.map( condition => s"${condition.fieldName} ${condition.conditionType} ${condition.value}" ).mkString(" AND ")).getOrElse(""))
}

@layout.edit(
    domainName,
	form.errors,
    elements,
    router.update(id),
    router.plainList,
    Some(router.delete(id)),
    Some(datasetMenu(dataSpaceMetaInfos)),
    Some(datasetSubNav())
)