@import controllers.dataset.DataSetJsRouter

@(
    widgetCallbackId: String,
    widgetGridElementWidth: Int
)(
    implicit request: Request[_]
)

<script type="text/javascript">
    dataSetJsRoutes.controllers.dataset.DataSetDispatcher.getWidgets().ajax( {
        data: {
            "callbackId": '@widgetCallbackId'
        },
        success: function(data) {
            $("#widgetsTr").html("")
            $.each(data, function (i, widgets) {
                var td = $("<td style='vertical-align:top'>")
                var row = $("<div class='row'>")
                $.each(widgets, function (j, widget) {
                    row.append(widgetDiv(widget, @widgetGridElementWidth))
                })
                td.append(row)
                $("#widgetsTr").append(td)
            })
            $.each(data, function (i, widgets) {
                var filterElement = $("#filter" + i)
                $.each(widgets, function (j, widget) {
                    genericWidget(widget, filterElement)
                })
            })
        },
        error: function(data){
            $("#widgetsTr").html("")
            showErrorResponse(data)
        }
    });
</script>