@import views.html.layout.formErrors
@import org.incal.play.controllers.WebContext._
@import org.incal.play.controllers.WebContext
@import views.html.filter.{filter => filterUI}
@import org.ada.web.util.typeColumns
@import controllers.requests.{routes => requestRoutes}
@import org.ada.server.models.FilterShowFieldStyle
@import views.html.dataset.filter.dataSetFilter
@import views.html.elements.labelValue
@import views.html.table.dynamicStringTable
@import reactivemongo.bson.BSONObjectID
@import controllers.requests.routes
@import views.html.table.displayTable
@import models.Action
@import models.RequestAction
@import play.api.libs.concurrent.Execution.Implicits.defaultContext
@import scala.concurrent.Future
@import org.incal.play.Page
@import play.api.libs.json.{JsObject, JsValue, Json}
@import views.html.dataset.jsonTable
@import play.api.libs.json.JsObject
@import org.ada.web.util.typeColumns
@import org.incal.core.FilterCondition
@import org.incal.play.Page
@import org.incal.play.controllers.WebContext
@import views.html.layout
@import views.html.table.paginatedTable
@import views.html.dataset.{dynamicFieldTable, dataSetExportDropdown}
@import views.html.table.dynamicTableJsImport
@import views.html.layout
@import views.html.elements.editableTextElements

@import org.incal.play.controllers.WebContext._
@import org.incal.play.controllers.WebContext
@import org.ada.server.models.Translation
@import org.incal.play.controllers.{WebContext, IdForm}
@import org.incal.play.controllers.WebContext._
@import org.ada.web.controllers.routes
@import views.html.elements._
@(
        displayName: String = "select items",
dataSetId: String,
        requestId: BSONObjectID,
page: Page[JsObject],
        fieldNames: Traversable[String]
    //  conditions: Seq[FilterCondition]
        )(
    implicit context: WebContext
    )





        @scheduleCheckbox = {
            <input type="checkbox" class="no-rowClicked"/>
            }



@table = @{
    val columns : Traversable[(Option[String], String, Any => Html )] =
           fieldNames.map(f => {
               (Some(f), f, (x: Any) => {
                 val item = x.asInstanceOf[JsObject]
                   val itemId = item.value.get("_id").get.as[JsObject].value.get("$oid").get
                itemField(item.value.get(f).get.toString(), itemId.toString())
               })
           })

               paginatedTable(
                   page,
                   (pageNumber, orderBy) => controllers.requests.routes.BatchOrderRequestsController.select(Some(requestId), dataSetId, pageNumber, orderBy) //, conditions)
                   ,
                   Seq((Some("select"), "Add to request", (x: Any) => scheduleCheckbox)) ++ columns,
                   None
               )
}

        @itemField(value: String, itemId: String) = {

            <span id="@itemId">
            @Html(value)
            </span>
        }



@layout.listWithButtons(
    "request",
    None,
    page.total,
    None,
    controllers.requests.routes.BatchOrderRequestsController.findActive(),
    requestId,
    dataSetId,
    Some(table),
    None
)



