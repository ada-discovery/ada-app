@import play.api.libs.json.JsObject
@import reactivemongo.bson.BSONObjectID
@import play.modules.reactivemongo.json._
@(domainName : String, currentPage: Page[JsObject], currentOrderBy: String, currentFilter: String, findCall : (Int, String, String) => Call, plainFindCall : Call, getCall : BSONObjectID => Call)(implicit flash: play.api.mvc.Flash, msg: play.api.i18n.Messages, request: RequestHeader)

@actions = {
@helper.form(action=plainFindCall, 'class -> "navbar-form navbar-left", 'role -> "search") {
    <input type="search" id="searchbox" name="f" value="@currentFilter" placeholder="Filter by Probanden Nr...">
    <input type="submit" id="searchsubmit" value="Filter by Probanden Nr" class="btn btn-primary btn-sm">
}
}

@displayCall(newPage : Int, newOrderBy : Option[String]) = @{
    findCall(newPage, newOrderBy.map { nOrderBy =>
        if (nOrderBy == currentOrderBy) {
            "-" + currentOrderBy
        } else if (("-" + nOrderBy) == currentOrderBy) {
            nOrderBy
        } else nOrderBy
    }.getOrElse(currentOrderBy), currentFilter)
}

@rowClickCall(item : JsObject) = @{
    getCall(item.value.get("_id").get.as[BSONObjectID]).url
}

@table = {
    @jsonTable(currentPage.items, currentOrderBy, displayCall(_, _),
        Some(List("Line_Nr", "Probanden_Nr", "Geb_Datum", "a_Gruppe", "b_Gruppe")),
        Some(rowClickCall)
    )
}

@views.html.list(
    domainName,
    actions,
    table,
    displayCall,
    currentPage,
    currentOrderBy,
    currentFilter
)