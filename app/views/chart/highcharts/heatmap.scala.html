@import util.shorten

@(
    chartElementName: String,
    chartSpec: HeatmapChartSpec
)

<div id="@chartElementName" class="chart-holder"></div>
<script type="text/javascript">
        $(function () {
            $('#@{chartElementName}').highcharts({
                chart: {
                    type: 'heatmap'
                },
                title: {
                    text:  "@chartSpec.title"
                },
                xAxis: {
                    categories: [ @chartSpec.xCategories.map { cat => '@cat', } ],
                    labels: {
                        formatter: function() {
                            return shorten(this.value, 10);

                        }
                    }
                },
                yAxis: {
                    categories: [ @chartSpec.xCategories.map { cat => '@cat', } ],
                    title: null,
                    labels: {
                        formatter: function() {
                            return shorten(this.value, 10);

                        }
                    }
                },
                credits: {
                    enabled: false
                },
                colorAxis: {
                    min: 0,
                    minColor: '#FFFFFF',
                    maxColor: Highcharts.getOptions().colors[0]
                },
                legend: {
                    align: 'right',
                    layout: 'vertical',
                    margin: 0,
                    verticalAlign: 'top',
                    y: 25,
                    symbolHeight: 280
                },
                tooltip: {
                    formatter: function () {
                        return '<b>' + this.series.xAxis.categories[this.point.x] + '</b><br><b>' +
                                this.series.yAxis.categories[this.point.y] + '</b><br>' + Highcharts.numberFormat(this.point.value, 3, '.');
                    },
                    valueDecimals: 2
                },
                series: [{
                    name: "@chartSpec.title",
                    borderWidth: 1,
                    data: [
                        @chartSpec.data.zipWithIndex.map { case (seq, i) =>
                            @seq.zipWithIndex.map { case (value, j) =>
                                [@i, @j, @value.getOrElse(0)],
                            }
                        }
                    ],
                    dataLabels: {
                        enabled: false,
                        color: '#000000'
                    }
                }]
            });
        });
</script>