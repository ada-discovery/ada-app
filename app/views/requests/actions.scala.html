
@import views.html.elements.editableTextElements

@import org.ada.server.models.Translation
@import org.incal.play.controllers.{WebContext, IdForm}
@import org.incal.play.controllers.WebContext._
@import org.ada.web.controllers.routes
@import views.html.elements._
@import services.request.ActionGraph
@import models.Action
@import views.html.table.paginatedTable
@import reactivemongo.bson.BSONObjectID
@import views.html.table.{displayTable, dynamicTable}
@import org.ada.web.util.typeColumns
@import services.request.RoleProviderService
@(
        data: IdForm[BSONObjectID, BatchOrderRequest],
        role: Role.Value
)(
        implicit context: WebContext
)

@elements = {
@inputText("request", "dataSetId", data.form)

<input type="hidden" name="state" value=""/>

@table
}



@table = {
@displayTable(
    data.form.value.get.itemIds,
    typeColumns[(BSONObjectID)](
        (Some("item"), "item", _.stringify )
    )
)
}


@layout.editActions(
    "Update request status as " + role,
    "request",
    ActionGraph.apply.get(data.form.get.state).orElse(Some(Traversable[Action]())).get,
    Some(role),
    data.form.get._id.get,
    data.form.get.history,
    errors = data.form.errors,
    elements = elements,
    updateCall = controllers.requests.routes.BatchOrderRequestsController.update(data.id),
    cancelCall = controllers.requests.routes.BatchOrderRequestsController.findActive(),
    None,
    None
)
